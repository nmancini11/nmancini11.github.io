function fixMiCharts(){var t=d3.select("#mainbarchart").select("svg"),e=d3.select("#sidechart").select("svg");t.empty()&&e.empty()||(t.remove(),e.remove()),d3.csv("data/runandgun.csv").row(function(t){return{skater:t.skater,stance:t.stance,dismounts:t.dismounts,timeBetweenTricks:t.timeBetweenTricks.split(","),tricks:t.tricks.split(" || ")}}).get(function(t,e){function a(t){return function(e){var a=d3.interpolate(e.endAngle,t);return function(t){return e.endAngle=a(t),p(e)}}}for(var r=0;r<e.length;r++)e[r].timeBetweenTricks.length!==e[r].tricks.length?console.log(e[r].skater+" is fucked up. # Timestamps: "+e[r].timeBetweenTricks.length+" # Tricks: "+e[r].tricks.length):console.log("every trick has a timestamp, noice!");var n=document.getElementById("mainbarchart").offsetWidth,s=d3.max(e,function(t){return t.tricks.length}),i={left:130,right:8,top:10,bottom:0},d=d3.scaleSequential(d3.interpolateViridis).domain([0,10]),l=d3.scaleLinear().domain([0,s]).range([0,n-i.right-i.left]),c=d3.axisBottom(l),o=d3.select("#mainbarchart").append("svg").attr("height","100%").attr("width","100%"),m=o.append("g").attr("transform","translate("+i.left+","+i.top+")");e.forEach(function(t){m.append("text").attr("class","line-label").attr("id",t.skater.replace(/ /g,"")).attr("y",8+35*e.indexOf(t)).attr("x",-110).transition().ease(d3.easeCubic).duration(1e3).delay(150).attr("x",-130).attr("class","skater").attr("color",d(e.indexOf(t))).text(t.skater),m.append("rect").attr("class","rect").attr("y",35*e.indexOf(t)).attr("x","0").attr("height","5").transition().ease(d3.easeCubic).duration(1e3).delay(150).attr("width",t.tricks.length/s*(n-i.right-i.left)).attr("fill",d(e.indexOf(t)))}),m.append("g").attr("class","x axis").attr("transform","translate(0,380)").call(c);var h=2*Math.PI,u=d3.select("#sidechart").append("svg"),g=document.getElementById("sidechart").offsetWidth,f=document.getElementById("sidechart").offsetHeight,k=u.append("g").attr("transform","translate("+g/1.9+","+f/2+")"),p=d3.arc().innerRadius(g/3.1).outerRadius(g/3.1+10).startAngle(0);u.append("text").attr("class","line-label").attr("y",f/1.78).attr("x",g/2.53).style("stroke","green","text-align","center").text("seconds"),u.append("text").attr("class","line-label").attr("y",f/2).attr("x",g/2.3).style("font-size","36px").text(Math.round(d3.sum(e[skaterIndex].timeBetweenTricks)+1.5)),k.append("path").datum({endAngle:h}).style("fill","#ddd").attr("d",p);var x=k.append("path").style("fill","#44bf70").datum({endAngle:0}).attr("d",p);d3.select("#mainbarchart text").on("click",function(){selectedSkater===this.id?console.log("fuck"):(selectedSkater=this.id,skaterString=selectedSkater.split(/(?=[A-Z])/).join(" "),skaterIndex=e.map(function(t){return t.skater}).indexOf(skaterString),$("#mainbarchart").find(".selected").removeClass("selected"),$(this).addClass("selected"),console.log(selectedSkater.split(/(?=[A-Z])/).join(" ")+" is currently selected"),console.log("time between tricks: "+d3.sum(e[skaterIndex].timeBetweenTricks))),x.transition().duration(750).attrTween("d",a(Math.round((d3.sum(e[skaterIndex].timeBetweenTricks)+1.5)/9.549296586)))})})}var selectedSkater="EvanSmith",skaterIndex=[3],skaterString="Evan Smith";d3.select(window).on("resize",fixMiCharts),fixMiCharts();