function fixMiCharts(){var t=d3.select("#mainbarchart").select("svg"),e=d3.select("#sidechart").select("svg");t.empty()&&e.empty()||(t.remove(),e.remove()),d3.csv("data/runandgun.csv").row(function(t){return{skater:t.skater,stance:t.stance,dismounts:t.dismounts,timeBetweenTricks:t.timeBetweenTricks.split(","),tricks:t.tricks.split(" || ")}}).get(function(t,e){function a(t){return function(e){var a=d3.interpolate(e.endAngle,t);return function(t){return e.endAngle=a(t),x(e)}}}for(var n=0;n<e.length;n++)e[n].timeBetweenTricks.length!==e[n].tricks.length?console.log(e[n].skater+" is fucked up."):console.log("every trick has a timestamp, noice!");var r=document.getElementById("mainbarchart").offsetWidth,i=d3.max(e,function(t){return t.tricks.length}),s={left:130,right:50,top:40,bottom:0},d=d3.scaleSequential(d3.interpolateViridis).domain([0,10]),l=d3.scaleLinear().domain([0,i]).range([0,r-s.right-s.left]),c=d3.axisBottom(l),o=d3.select("#mainbarchart").append("svg").attr("height","100%").attr("width","100%"),f=o.append("g").attr("transform","translate("+s.left+","+s.top+")");e.forEach(function(t){f.append("text").attr("class","line-label").attr("y",8+35*e.indexOf(t)).attr("x",-110).transition().ease(d3.easeCubic).duration(1e3).delay(150).attr("x",-130).style("stroke",d(e.indexOf(t))).text(t.skater),f.append("rect").attr("class","rect").attr("y",35*e.indexOf(t)).attr("x","0").attr("height","5").transition().ease(d3.easeCubic).duration(1e3).delay(150).attr("width",t.tricks.length/i*(r-s.right-s.left)).attr("fill",d(e.indexOf(t)))}),f.append("g").attr("class","x axis").attr("transform","translate(0,350)").call(c);var u=2*Math.PI,p=d3.select("#sidechart").append("svg"),h=document.getElementById("sidechart").offsetWidth,g=document.getElementById("sidechart").offsetHeight,m=p.append("g").attr("transform","translate("+h/1.9+","+g/2+")"),x=d3.arc().innerRadius(h/3).outerRadius(h/3+10).startAngle(0);p.append("text").attr("class","line-label").attr("y",g/1.78).attr("x",h/2.53).style("stroke","green","text-align","center").text("seconds"),p.append("text").attr("class","line-label").attr("y",g/2).attr("x",h/2.3).style("font-size","36px").text(Math.round(d3.sum(e[2].timeBetweenTricks)+1.5)),m.append("path").datum({endAngle:u}).style("fill","#ddd").attr("d",x);var k=m.append("path").datum({endAngle:.527*u}).style("fill","#44bf70").attr("d",x);d3.interval(function(){k.transition().duration(750).attrTween("d",a(Math.random()*u))},1500)})}d3.select(window).on("resize",fixMiCharts),fixMiCharts();